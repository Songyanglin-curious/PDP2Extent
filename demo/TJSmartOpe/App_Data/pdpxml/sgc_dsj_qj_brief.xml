<?xml version="1.0" encoding="utf-8" ?>
<ROOT>
<ds71><![CDATA[   
          SELECT DTNAME,COUNT(1) AS TOTAL, DTID FROM(
          SELECT DT.DTNAME, D.DTID FROM "MONITORSIGNAL"."B_DEVICE{{0}}" D
          JOIN "MONITORSIGNAL"."B_DEVICETYPE" DT ON D.DTID=DT.DT_ID AND DT_ID < 7 WHERE D5000NAME IS NOT NULL)
          GROUP BY DTNAME, DTID
          ORDER BY  DTID
        ]]></ds71>
<ds76><![CDATA[  
          SELECT V.V_NAME,S.CONTENT
          FROM "MONITORSIGNAL"."STATIONCONTENT" S JOIN "MONITORSIGNAL"."B_VOLTAGE" V
          ON S.V_ID=V.V_ID
          WHERE V.ISVALID=1
          ORDER BY V.V_ID
        ]]></ds76>
<ds80><![CDATA[
          SELECT V_NAME, COUNT(*) AS LINENUM, SUM("LENGTH") AS LINELENGTH, V_VALUE FROM "MONITORSIGNAL"."B_DEVICE{{0}}" D
		      JOIN "SG_THEME"."SG_DEV_ACLINE_B" L ON D.CLOUDID = L.ID 
		      JOIN "MONITORSIGNAL"."B_VOLTAGE" V ON D.VOLID = V.V_ID
          GROUP BY V_NAME, V_VALUE
          ORDER BY V_VALUE DESC
        ]]></ds80>
<ds89><![CDATA[ 
        select * from (
          SELECT top 6 FACTORY_JC,COUNT(*) as NUM 
          FROM "ESDC_ODS"."T_EC_PROTECTBASE" A
          JOIN "MONITORSIGNAL"."B_SUBSTATION{{0}}" STA ON A.STATION = STA.OMSID AND ISMONITOR = 1
          JOIN "ESDC_ODS"."T_EC_FACTORY" F ON A.MANUFACTURER = F.FACTORY_ID
          GROUP BY FACTORY_JC
          ORDER BY 2 DESC
          )
          union all
          select '其他' as M_MNAME,sum(NUM) as NUM from (
          SELECT  FACTORY_JC,COUNT(*) as NUM 
          FROM "ESDC_ODS"."T_EC_PROTECTBASE" A
          JOIN "MONITORSIGNAL"."B_SUBSTATION{{0}}" STA ON A.STATION = STA.OMSID AND ISMONITOR = 1
          JOIN "ESDC_ODS"."T_EC_FACTORY" F ON A.MANUFACTURER = F.FACTORY_ID
          where 
          FACTORY_JC not in 
          (
          select FACTORY_JC from (
          SELECT top 6 FACTORY_JC,COUNT(*)
          FROM "ESDC_ODS"."T_EC_PROTECTBASE" A
          JOIN "MONITORSIGNAL"."B_SUBSTATION{{0}}" STA ON A.STATION = STA.OMSID AND ISMONITOR = 1
          JOIN "ESDC_ODS"."T_EC_FACTORY" F ON A.MANUFACTURER = F.FACTORY_ID
          GROUP BY FACTORY_JC
          ORDER BY 2 DESC
          )
          )
          GROUP BY FACTORY_JC
          ORDER BY 2 DESC
          )          ]]></ds89>
<ds94><![CDATA[  
          SELECT V.V_NAME, COUNT(*)
          FROM MONITORSIGNAL.B_SUBSTATION{{0}} S JOIN "MONITORSIGNAL"."B_VOLTAGE" V
          ON S.MAXVOLTAGE = V.V_ID
          WHERE ISMONITOR = 1
          GROUP BY V.V_NAME
        ]]></ds94>
<ds48><![CDATA[
          SELECT * FROM 
          (SELECT TOP 5 B.CLOUDID, "STA_DAY", "DTTYPE", "SBLX", "STATIONIDX", SIGNALNUM/10000.0 AS SIGNALNUM, B.S_NAME FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}" A
          JOIN "MONITORSIGNAL"."B_SUBSTATION{{0}}" B ON A.STATIONIDX = B.S_ID AND B.ISMONITOR = 1
          WHERE STA_DAY = (SELECT MAX(STA_DAY) FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}") AND DTTYPE='YEAR' AND SBLX = '变压器'
          ORDER BY SIGNALNUM DESC) A
          ORDER BY SIGNALNUM ASC
        ]]></ds48>
<ds54><![CDATA[
          SELECT * FROM 
          (SELECT TOP 5 B.CLOUDID, "STA_DAY", "DTTYPE", "SBLX", "STATIONIDX", SIGNALNUM/10000.0 AS SIGNALNUM, B.S_NAME FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}" A
          JOIN "MONITORSIGNAL"."B_SUBSTATION{{0}}" B ON A.STATIONIDX = B.S_ID AND B.ISMONITOR = 1
          WHERE STA_DAY = (SELECT MAX(STA_DAY) FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}") AND DTTYPE='YEAR' AND SBLX = '保护设备'
          ORDER BY SIGNALNUM DESC) A
          ORDER BY SIGNALNUM ASC
        ]]></ds54>
<ds60><![CDATA[
          SELECT * FROM 
          (SELECT TOP 5 B.CLOUDID, "STA_DAY", "DTTYPE", "SBLX", "STATIONIDX", SIGNALNUM/10000.0 AS SIGNALNUM, B.S_NAME FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}" A
          JOIN "MONITORSIGNAL"."B_SUBSTATION{{0}}" B ON A.STATIONIDX = B.S_ID AND B.ISMONITOR = 1
          WHERE STA_DAY = (SELECT MAX(STA_DAY) FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}") AND DTTYPE='YEAR' AND SBLX = '普通开关'
          ORDER BY SIGNALNUM DESC) A
          ORDER BY SIGNALNUM ASC
        ]]></ds60>
<ds66><![CDATA[
          SELECT * FROM 
          (SELECT TOP 5 B.CLOUDID, "STA_DAY", "DTTYPE", "SBLX", "STATIONIDX", SIGNALNUM/10000.0 AS SIGNALNUM, B.S_NAME FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}" A
          JOIN "MONITORSIGNAL"."B_SUBSTATION{{0}}" B ON A.STATIONIDX = B.S_ID AND B.ISMONITOR = 1
          WHERE STA_DAY = (SELECT MAX(STA_DAY) FROM "MONITORSIGNAL"."QJ_JKGJXX_SBFLTJ{{0}}") AND DTTYPE='YEAR' AND SBLX = '自动化设备'
          ORDER BY SIGNALNUM DESC) A
          ORDER BY SIGNALNUM ASC
        ]]></ds66></ROOT>