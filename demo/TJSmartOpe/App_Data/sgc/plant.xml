<?xml version="1.0" encoding="utf-8" ?>
<ROOT>
  <GetPwrGrid>
    <![CDATA[SELECT id,name,parent_id FROM ]]>
  <![CDATA[same:SearchCommonSql:SchemaName]]>
  <![CDATA[SG_CON_PWRGRID_B]]>
  </GetPwrGrid>
  <WhereType>
    <![CDATA[A.PLANT_TYPE IN ({0})]]>
  </WhereType>
  <GetTingDianYa>
    <![CDATA[    
    SELECT A.ID,A.NAME,E.NAME,C.CAPACITY,D.ID,D.NAME,F.ID,F.NAME_ABBREVIATION,B.ID,B.NAME_ABBREVIATION,A.OPERATE_DATE,A.LONGITUDE,A.LATITUDE,A.EXPIRY_DATE,A.OPERATE_STATE
    FROM ]]>
    <![CDATA[same:SearchCommonSql:SchemaName]]>
    <![CDATA[SG_CON_PLANT_B AS A 
    LEFT JOIN ]]>
    <![CDATA[same:SearchCommonSql:SchemaName]]>
    <![CDATA[SG_ORG_DCC_B AS B ON A.DCC_ID=B.ID 
    LEFT JOIN ]]>
    <![CDATA[same:SearchCommonSql:SchemaName]]>
    <![CDATA[SG_CON_PLANT_S AS C ON A.ID=C.ID AND C.VOLTAGE_TYPE=9999 AND C.STATE_CODE=1003
    LEFT JOIN ]]>
    <![CDATA[same:SearchCommonSql:SchemaName]]>
    <![CDATA[SG_CON_PWRGRID_B AS D ON A.CONNECTIVE_PG_ID=D.ID 
    LEFT JOIN ]]>
    <![CDATA[same:SearchCommonSql:SchemaName]]>
    <![CDATA[SG_ORG_COMPANY_B AS F ON A.COMPANY_ID=F.ID 
    LEFT JOIN ]]>
    <![CDATA[same:SearchCommonSql:SchemaName]]>
    <![CDATA[SG_DIC_VOLTAGETYPE AS E ON A.MAX_VOLTAGE_TYPE=E.CODE
    WHERE A.PLANT_TYPE IN ({0}) AND A.MAX_VOLTAGE_TYPE IN ({1})
    ORDER BY C.CAPACITY DESC
    ]]>
  </GetTingDianYa>
  <YanBian>
    <![CDATA[
    SELECT YEAR,SUM(CAPACITY) FROM (
    SELECT to_char(A.OPERATE_DATE,'YYYY') AS YEAR,C.CAPACITY
    FROM SG_CON_PLANT_B AS A 
    INNER JOIN SG_CON_PLANT_S AS C ON A.ID=C.ID 
    )
    WHERE YEAR<'2019' AND YEAR>='2009'
    GROUP BY YEAR
    ORDER BY YEAR     
    ]]>
  </YanBian>
  <FaDian>
    <![CDATA[
    SELECT F.NAME_ABBREVIATION,S.CAPACITY FROM (
      SELECT A.COMPANY_ID,SUM(C.CAPACITY) AS CAPACITY
      FROM SG_CON_PLANT_B AS A INNER JOIN SG_CON_PLANT_S AS C ON A.ID=C.ID AND C.VOLTAGE_TYPE=9999
      WHERE  A.PLANT_TYPE IN ({0}) AND A.MAX_VOLTAGE_TYPE IN ({1})
      GROUP BY A.COMPANY_ID
    ) S JOIN SG_ORG_COMPANY_B AS F ON S.COMPANY_ID=F.ID 
    ORDER BY S.CAPACITY DESC    
    ]]>
  </FaDian>
  <DianWang>
    <![CDATA[
      SELECT A.CONNECTIVE_PG_ID,SUM(C.CAPACITY) AS CAPACITY
    FROM SG_CON_PLANT_B AS A 
    INNER JOIN SG_CON_PLANT_S AS C ON A.ID=C.ID AND C.VOLTAGE_TYPE=9999
    WHERE  A.PLANT_TYPE IN ({0}) AND A.MAX_VOLTAGE_TYPE IN ({1})
    GROUP BY A.CONNECTIVE_PG_ID
    ]]>
  </DianWang>
  <DianYaDengJi>
    <![CDATA[
    SELECT E.NAME,SUM(C.CAPACITY)
    FROM SG_CON_PLANT_B AS A 
    INNER JOIN SG_CON_PLANT_S  C ON A.ID=C.ID  AND C.VOLTAGE_TYPE=9999
    INNER JOIN SG_DIC_VOLTAGETYPE AS E ON A.MAX_VOLTAGE_TYPE=E.CODE
    WHERE  A.PLANT_TYPE IN ({0}) AND A.MAX_VOLTAGE_TYPE IN ({1})
    GROUP BY E.NAME
    ]]>
  </DianYaDengJi>
  <ZhuangJiTop>
    <![CDATA[
    SELECT TOP 10 A.NAME,C.CAPACITY
    FROM SG_CON_PLANT_B AS A
    INNER JOIN SG_CON_PLANT_S AS C ON A.ID=C.ID AND C.VOLTAGE_TYPE=9999
    WHERE  A.PLANT_TYPE IN ({0}) AND A.MAX_VOLTAGE_TYPE IN ({1})
    ORDER BY C.CAPACITY DESC
    ]]>
  </ZhuangJiTop>
  <ZhuangJiBottom>
    <![CDATA[
    SELECT A.NAME,C.CAPACITY
    FROM SG_CON_PLANT_B AS A 
    INNER JOIN SG_CON_PLANT_S  C ON A.ID=C.ID  AND C.VOLTAGE_TYPE=9999
    WHERE  A.PLANT_TYPE IN ({0}) AND A.MAX_VOLTAGE_TYPE IN ({1})
    ORDER BY C.CAPACITY  ASC LIMIT 10
    ]]>
  </ZhuangJiBottom>
  <GetPlantsMaxPowerTime>
    <![CDATA[SELECT MAX(CREATE_TIME) FROM ]]>
  <![CDATA[same:SearchCommonSql:SchemaName]]>
  <![CDATA[SG_CON_PLANT_H1_MEA_{0} WHERE MEAS_TYPE='30022001']]>
  </GetPlantsMaxPowerTime>
  <GetPlantsPower>
    <![CDATA[SELECT p.ID,p.LONGITUDE,p.LATITUDE,V00,V01,V02,V03,V04,V05,V06,V07,V08,V09,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37,V38,V39,V40,V41,V42,V43,V44,V45,V46,V47,V48,V49,V50,V51,V52,V53,V54,V55,V56,V57,V58,V59,s.CAPACITY
    FROM ]]>
  <![CDATA[same:SearchCommonSql:SchemaName]]>
  <![CDATA[SG_CON_PLANT_H1_MEA_{1} m JOIN ]]>
  <![CDATA[same:SearchCommonSql:SchemaName]]>
  <![CDATA[SG_CON_PLANT_B p ON m.ID=p.ID JOIN ]]>
  <![CDATA[same:SearchCommonSql:SchemaName]]>
  <![CDATA[SG_CON_PLANT_S s ON p.ID=s.ID AND s.VOLTAGE_TYPE=9999 AND s.STATE_CODE=1003
  WHERE m.MEAS_TYPE='30022001' AND m.CREATE_TIME={0} AND s.CAPACITY>0]]>
  </GetPlantsPower>
</ROOT>
